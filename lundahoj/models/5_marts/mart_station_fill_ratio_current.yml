version: 2

models:
  - name: mart_station_fill_ratio_current
    description: One row per station with latest snapshot and computed fill_ratio.
    columns:
      - name: station_id
        tests: [not_null, unique, relationships:
          {to: ref('stg_station_snapshot'), field: station_id}]
      - name: latitude
        tests: [not_null]
      - name: longitude
        tests: [not_null]
      - name: capacity
        tests:
          - not_null
      - name: bikes_available
        tests:
          - not_null
      - name: docks_available
        tests:
          - not_null
      - name: fill_ratio
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 1
              inclusive: true
      - name: latest_ts_utc
        tests:
          - not_null